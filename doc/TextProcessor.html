<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class TextProcessor - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/darkfish.js"></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-text_delete_ex">#text_delete_ex</a>
    
    <li ><a href="#method-i-text_delete_in">#text_delete_in</a>
    
    <li ><a href="#method-i-text_exclude">#text_exclude</a>
    
    <li ><a href="#method-i-text_include">#text_include</a>
    
    <li ><a href="#method-i-text_mixer">#text_mixer</a>
    
    <li ><a href="#method-i-text_mixer_exclude">#text_mixer_exclude</a>
    
    <li ><a href="#method-i-text_mixer_include">#text_mixer_include</a>
    
    <li ><a href="#method-i-text_mixer_range_copy">#text_mixer_range_copy</a>
    
    <li ><a href="#method-i-text_mixer_range_delete">#text_mixer_range_delete</a>
    
    <li ><a href="#method-i-text_mixer_range_exclude">#text_mixer_range_exclude</a>
    
    <li ><a href="#method-i-text_mixer_range_include">#text_mixer_range_include</a>
    
    <li ><a href="#method-i-text_mixer_range_insert">#text_mixer_range_insert</a>
    
    <li ><a href="#method-i-text_mixer_range_move">#text_mixer_range_move</a>
    
    <li ><a href="#method-i-text_write_area">#text_write_area</a>
    
    <li ><a href="#method-i-text_write_lines">#text_write_lines</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-TextProcessor">
  <h1 id="class-TextProcessor" class="class">
    class TextProcessor
  </h1>

  <section class="description">
    
<p><a href="TextProcessor.html">TextProcessor</a> is responsible for all of
the functions performed on a copy of the file. Unless an overwrite of the
original file is specifically requested, Any overwrites are done by <a
href="FileManager.html">FileManager</a>.</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Basic initialization</p>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 6</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>
  <span class="ruby-ivar">@file_manager</span>      = <span class="ruby-constant">FileManager</span>.<span class="ruby-identifier">new</span> 
  <span class="ruby-ivar">@new_text_area</span>     = {}
  <span class="ruby-ivar">@text_lines</span>        = {}
  <span class="ruby-ivar">@line_start</span>        = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@line_end</span>          = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@block_prior_line</span>  = []
  <span class="ruby-ivar">@block_prior_type</span>  = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-ivar">@block_prior_count</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@block_prior_index</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@block_start_line</span>  = []
  <span class="ruby-ivar">@block_start_type</span>  = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-ivar">@block_start_count</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@block_start_index</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@block_end_line</span>    = []
  <span class="ruby-ivar">@block_end_type</span>    = <span class="ruby-string">&#39;&#39;</span>
  <span class="ruby-ivar">@block_end_count</span>   = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@block_end_index</span>   = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@keys</span>              = []
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-text_delete_ex" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_delete_ex</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ol><li>
<p>Delete all excluded text</p>
</li></ol>

<p>Request is for all excluded lines to be deleted from the display.
test_text_exclude_0400 is the test case.</p>
          
          

          
          <div class="method-source-code" id="text_delete_ex-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 124</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_delete_ex</span> 
    <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ta</span><span class="ruby-operator">|</span>  
      <span class="ruby-identifier">ta1</span> = <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>]                       
    <span class="ruby-keyword">if</span> <span class="ruby-node">/#{Regexp.escape(&quot;text&quot;)}/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">ta1</span>[<span class="ruby-value">0</span>]) 
      <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>])          
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span> 
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@new_text_area</span> 
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_delete_in" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_delete_in</span><span
            class="method-args">(text_lines)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ol><li>
<p>Delete all included text</p>
</li></ol>

<p>Request is for all included lines to be deleted from the display. All
excluded lines are included. test_text_exclude_0300 is the test case.</p>
          
          

          
          <div class="method-source-code" id="text_delete_in-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 108</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_delete_in</span>(<span class="ruby-identifier">text_lines</span>)
  <span class="ruby-identifier">line_number</span>  = <span class="ruby-value">0</span>
  <span class="ruby-identifier">text_area</span>    = {}   
  <span class="ruby-identifier">text_lines</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line_num</span>, <span class="ruby-identifier">text</span><span class="ruby-operator">|</span>                                <span class="ruby-comment"># read the file line by line</span>
    <span class="ruby-identifier">found</span> = <span class="ruby-keyword">false</span> 
    <span class="ruby-identifier">$search_history</span>.<span class="ruby-identifier">to_h</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">symbol</span>, <span class="ruby-identifier">pattern</span><span class="ruby-operator">|</span>              <span class="ruby-comment"># get the current search patterns</span>
      <span class="ruby-identifier">found</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-node">/#{Regexp.escape(pattern)}/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">text</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">pattern</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">line_number</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>, [<span class="ruby-string">&quot;text&quot;</span>, <span class="ruby-identifier">text</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">found</span>    <span class="ruby-comment"># write out this line if not found</span>
  <span class="ruby-keyword">end</span> 
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">text_area</span> 
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_exclude" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_exclude</span><span
            class="method-args">(text_area)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ol><li>
<p>Additional exclude pattern</p>
</li></ol>
          
          

          
          <div class="method-source-code" id="text_exclude-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 74</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_exclude</span>(<span class="ruby-identifier">text_area</span>)
  <span class="ruby-ivar">@new_text_area</span> = {}
  <span class="ruby-ivar">@line_number</span>   = <span class="ruby-value">0</span>
  <span class="ruby-identifier">$search_history</span>.<span class="ruby-identifier">to_h</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">symbol</span>, <span class="ruby-identifier">pattern</span><span class="ruby-operator">|</span>               <span class="ruby-comment"># get possible last search pattern</span>
     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">pattern</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span>                                                                                     
       <span class="ruby-ivar">@pattern</span> = <span class="ruby-identifier">pattern</span>                                           <span class="ruby-comment"># set it for now</span>
     <span class="ruby-keyword">else</span>
       <span class="ruby-keyword">break</span>                                                        <span class="ruby-comment"># past last one</span>
     <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>               
  <span class="ruby-identifier">text_area</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ta</span><span class="ruby-operator">|</span>                                               <span class="ruby-comment"># read the file line by line</span>
    <span class="ruby-ivar">@line_number</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">ta1</span>     = <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>]                                                     <span class="ruby-comment"># get [&quot;control&quot;, text]</span>
    <span class="ruby-identifier">data</span>    = <span class="ruby-identifier">ta1</span>[<span class="ruby-value">1</span>]                                                   <span class="ruby-comment"># get text or count</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-node">/#{Regexp.escape(@pattern)}/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">data</span>)
        <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@line_number</span>, [<span class="ruby-string">&quot;fill&quot;</span>, <span class="ruby-string">&quot;&quot;</span>])           <span class="ruby-comment"># yes, exclude it</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@line_number</span>, <span class="ruby-identifier">ta1</span>)                    <span class="ruby-comment"># no, copy line over                                              </span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@line_number</span>, <span class="ruby-identifier">ta1</span>)                      <span class="ruby-comment"># not a string, copy line over</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># I am happy with the code above but it still needs formatting</span>
  <span class="ruby-ivar">@new_text_area</span> = {}
  <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-value">0</span>, [<span class="ruby-string">&quot;text&quot;</span>, <span class="ruby-string">&quot;Not yet implemented&quot;</span>])
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@new_text_area</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_include" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_include</span><span
            class="method-args">(text_lines)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ol><li>
<p>Additional include pattern</p>
</li></ol>

<p>This builds a hash table of the initial included lines.</p>
<ul><li>
<p>It runs a search history to support multiple includes.</p>
</li><li>
<p>It does the Regexp matching for each pattern for each line.</p>
</li><li>
<p>Everything is counted and excluded until a match is found.</p>
</li><li>
<p>At that point the excluded count is written and text follows.</p>
</li></ul>

<p>This logic repeats until the “after count is written if required.</p>
          
          

          
          <div class="method-source-code" id="text_include-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 40</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_include</span>(<span class="ruby-identifier">text_lines</span>)
  <span class="ruby-ivar">@text_end</span>      = <span class="ruby-identifier">text_lines</span>.<span class="ruby-identifier">length</span>                              <span class="ruby-comment"># actual data length used everywhere</span>
  <span class="ruby-ivar">@text_area</span>     = {}
  <span class="ruby-ivar">@exclude_count</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@line_number</span>   = <span class="ruby-value">-1</span>
  <span class="ruby-ivar">@found</span>         = <span class="ruby-keyword">false</span> 
  <span class="ruby-identifier">after</span>          = <span class="ruby-keyword">false</span>  
  <span class="ruby-identifier">text_lines</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line_number</span>, <span class="ruby-identifier">text</span><span class="ruby-operator">|</span>                        <span class="ruby-comment"># read the file line by line</span>
    <span class="ruby-ivar">@line_number</span> = <span class="ruby-identifier">line_number</span>                                  <span class="ruby-comment"># formal argument cannot be an instance variable</span>
    <span class="ruby-identifier">$search_history</span>.<span class="ruby-identifier">to_h</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">symbol</span>, <span class="ruby-identifier">pattern</span><span class="ruby-operator">|</span>          <span class="ruby-comment"># get the current search patterns</span>
      <span class="ruby-ivar">@pattern</span> = <span class="ruby-identifier">pattern</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">pattern</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span>                    <span class="ruby-comment"># formal argument cannot be an instance variable</span>
      <span class="ruby-ivar">@found</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-node">/#{Regexp.escape(pattern)}/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">text</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">pattern</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@found</span>                                                          <span class="ruby-comment"># is it what is being looked for?</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@exclude_count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>                                            <span class="ruby-comment"># yes, none excluded yet?</span>
        <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@line_number</span>, [<span class="ruby-string">&quot;before&quot;</span>, <span class="ruby-ivar">@exclude_count</span>])      <span class="ruby-comment"># no, write out excluded line count</span>
      <span class="ruby-keyword">end</span>                                                      
      <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@line_number</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>, [<span class="ruby-string">&quot;text&quot;</span>, <span class="ruby-identifier">text</span>])                  <span class="ruby-comment"># always write out this line</span>
      <span class="ruby-ivar">@exclude_count</span> = <span class="ruby-value">0</span>                                                <span class="ruby-comment"># no lines currently excluded</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@line_number</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>, [<span class="ruby-string">&quot;fill&quot;</span>, <span class="ruby-string">&quot;&quot;</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@line_number</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@text_end</span> <span class="ruby-comment"># line position</span>
      <span class="ruby-ivar">@exclude_count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@line_number</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@text_end</span>                  <span class="ruby-comment"># handle single excluded last line</span>
    <span class="ruby-keyword">end</span> 
    <span class="ruby-ivar">@exclude_count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@found</span> 
    <span class="ruby-ivar">@found</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@exclude_count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> 
    <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@line_number</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>, [<span class="ruby-string">&quot;after&quot;</span>, <span class="ruby-ivar">@exclude_count</span>])
    <span class="ruby-ivar">@exclude_count</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@text_area</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_mixer" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_mixer</span><span
            class="method-args">(text_area, parameters)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The big picture is there are two things in play, the text_area which is
built as the first exclude display and the text_lines which is the original
input file used to rebuild the text_area as required. Beyond that the
requirement is to track the various “lines excluded” positions, the number
of lines excluded for various conditions related to the actions required in
rebuilding the original exclude display. In particular block start is the
exclude line information after the “after” line when doing any action. The
block end is needed for adjustments to the display for the exclude line
after the last line in the action range. While the block start information
is for the exclude after the beginning of the action range the block prior
is needed for rebuilding the display with actions requiring additional
excludes. Clearly if the prior exclude ends on the line before the
additional requested excludes starts the prior excludes need to be joined
with the current.</p>
          
          

          
          <div class="method-source-code" id="text_mixer-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 144</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_mixer</span>(<span class="ruby-identifier">text_area</span>, <span class="ruby-identifier">parameters</span>)
  <span class="ruby-identifier">original_file</span> = <span class="ruby-ivar">@file_manager</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:file_history_current</span>)                  <span class="ruby-comment"># get the original file</span>
  <span class="ruby-ivar">@text_lines</span>  = <span class="ruby-ivar">@file_manager</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:file_open</span>, <span class="ruby-identifier">original_file</span>)              <span class="ruby-comment"># open it</span>
  <span class="ruby-ivar">@text_end</span>    = <span class="ruby-ivar">@text_lines</span>.<span class="ruby-identifier">length</span>                                        <span class="ruby-comment"># actual data length</span>
  <span class="ruby-ivar">@text_area</span>    = <span class="ruby-identifier">text_area</span>                                                  <span class="ruby-comment"># contains display area</span>
  <span class="ruby-ivar">@area_end</span>    = <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">length</span>                                          <span class="ruby-comment"># actual area length</span>
  <span class="ruby-ivar">@selection</span>   = <span class="ruby-identifier">parameters</span>[<span class="ruby-value">0</span>]
  <span class="ruby-ivar">@line_start</span>  = <span class="ruby-identifier">parameters</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span>                                    <span class="ruby-comment"># lower boundary for line data changes</span>
  <span class="ruby-ivar">@line_end</span>    = <span class="ruby-identifier">parameters</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">to_i</span>                                        <span class="ruby-comment"># upper boundary for line data changes</span>
  <span class="ruby-ivar">@keys</span>        = <span class="ruby-identifier">text_area</span>.<span class="ruby-identifier">keys</span>                                            <span class="ruby-comment"># text_area keys are the control areas</span>
  <span class="ruby-ivar">@block_first</span>  = <span class="ruby-ivar">@keys</span>.<span class="ruby-identifier">first</span>                                                <span class="ruby-comment"># end of text_area</span>
  <span class="ruby-ivar">@block_last</span>  = <span class="ruby-ivar">@keys</span>.<span class="ruby-identifier">last</span>                                                <span class="ruby-comment"># last control line in text_area</span>
  <span class="ruby-ivar">@line_end</span>    = <span class="ruby-ivar">@text_end</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@line_end</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@text_end</span>                        <span class="ruby-comment"># clean up directive </span>
  <span class="ruby-comment"># </span>
  <span class="ruby-comment"># find the section of data to modify based on finding the &quot;before&quot; type preceding and following the range</span>
  <span class="ruby-comment"># it is also necessary to keep track of the block prior to the block preceding for uses with excludes of excludes</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-ivar">@keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span>                                                          <span class="ruby-comment"># find start text_area type &quot;before&quot;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">k</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@line_start</span>                                                      <span class="ruby-comment"># use this to format new following data</span>
      <span class="ruby-ivar">@block_start_index</span> = <span class="ruby-identifier">k</span>                                                <span class="ruby-comment"># and new preceding &quot;before&quot; information</span>
      <span class="ruby-ivar">@block_start_line</span> = <span class="ruby-identifier">text_area</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-identifier">k</span>)                            <span class="ruby-comment"># get control value using line number as key</span>
      <span class="ruby-ivar">@block_start_line</span>.<span class="ruby-identifier">flatten!</span>                                            <span class="ruby-comment"># comes back as one array too many</span>
      <span class="ruby-ivar">@block_start_count</span> = <span class="ruby-ivar">@block_start_line</span>[<span class="ruby-value">1</span>]                              <span class="ruby-comment"># this is the amount to adjust</span>
      <span class="ruby-ivar">@block_start_type</span>  = <span class="ruby-ivar">@block_start_line</span>[<span class="ruby-value">0</span>]                              <span class="ruby-comment"># just to make it clear, not needed</span>
      <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@block_start_type</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;before&quot;</span>                                <span class="ruby-comment"># first one after k &gt; line_start </span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@block_start_index</span> = <span class="ruby-ivar">@keys</span>.<span class="ruby-identifier">last</span>                                        <span class="ruby-comment"># use last control number  </span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span>                                                        <span class="ruby-comment"># find prior text_area of type &quot;before&quot;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">k</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-ivar">@line_start</span>                                                    <span class="ruby-comment"># use this to format new excluded data</span>
      <span class="ruby-ivar">@block_prior_line</span> = <span class="ruby-identifier">text_area</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-identifier">k</span>)                            <span class="ruby-comment"># get control using line number as key</span>
      <span class="ruby-ivar">@block_prior_line</span>.<span class="ruby-identifier">flatten!</span>                                            <span class="ruby-comment"># comes back as one array too many</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@block_prior_line</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;before&quot;</span>                                  <span class="ruby-comment"># if this is a &quot;before&quot; control</span>
        <span class="ruby-ivar">@block_prior_count</span> = <span class="ruby-ivar">@block_prior_line</span>[<span class="ruby-value">1</span>]                          <span class="ruby-comment"># this is the amount to adjust</span>
        <span class="ruby-ivar">@block_prior_index</span> = <span class="ruby-identifier">k</span>                                              <span class="ruby-comment"># make this &quot;prior&quot; block</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>  
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span>                                                        <span class="ruby-comment"># find end text_area type &quot;before&quot;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">k</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@line_end</span>                                                      <span class="ruby-comment"># use this to format new preceeding data</span>
      <span class="ruby-ivar">@block_end_index</span> = <span class="ruby-identifier">k</span>                                                  <span class="ruby-comment"># and new following &quot;before&quot; information</span>
      <span class="ruby-ivar">@block_end_line</span>  = <span class="ruby-identifier">text_area</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-identifier">k</span>) 
      <span class="ruby-ivar">@block_end_line</span>.<span class="ruby-identifier">flatten!</span>
      <span class="ruby-ivar">@block_end_count</span> = <span class="ruby-ivar">@block_end_line</span>[<span class="ruby-value">1</span>]
      <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@block_end_line</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;before&quot;</span>                              <span class="ruby-comment"># first one after k &gt; line_end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@block_end_index</span> = <span class="ruby-ivar">@text_lines</span>.<span class="ruby-identifier">length</span>                                <span class="ruby-comment"># use end of file</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">parameters</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_mixer_exclude" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_mixer_exclude</span><span
            class="method-args">(parameters)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ol><li>
<p>Exclude additional lines.</p>
</li></ol>

<p>It runs through text_area excluding new lines as specified leaving out the
range of lines to be excluded. test_text_exclude_0200 is the test case.</p>
          
          

          
          <div class="method-source-code" id="text_mixer_exclude-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 214</span>
 <span class="ruby-keyword">def</span> <span class="ruby-identifier">text_mixer_exclude</span>(<span class="ruby-identifier">parameters</span>)
   <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-value">0</span>, [<span class="ruby-string">&quot;text&quot;</span>, <span class="ruby-string">&quot;Not yet implemented&quot;</span>])
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@new_text_area</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_mixer_include" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_mixer_include</span><span
            class="method-args">(parameters)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ol><li>
<p>Include additional lines.</p>
</li></ol>

<p>It runs through text_area including new lines as specified.
test_text_exclude_r100 is the test case.</p>
          
          

          
          <div class="method-source-code" id="text_mixer_include-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 201</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_mixer_include</span>(<span class="ruby-identifier">parameters</span>)
  <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ta</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@line_start</span> } 
  <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@line_start</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>, [<span class="ruby-string">&quot;before&quot;</span>, (<span class="ruby-ivar">@block_start_index</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@line_start</span>)<span class="ruby-operator">-</span><span class="ruby-value">1</span> ])
  <span class="ruby-identifier">text_write_lines</span>(<span class="ruby-ivar">@line_start</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>, <span class="ruby-ivar">@line_end</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>) 
  <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@block_end_index</span>, [<span class="ruby-string">&quot;before&quot;</span>, <span class="ruby-ivar">@block_end_index</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@line_end</span>])  
  <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ta</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@block_end_index</span> } 
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@new_text_area</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_mixer_range_copy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_mixer_range_copy</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ol><li>
<p>Copy lines.</p>
</li></ol>

<p>Request is for a block of lines to be copied</p>
          
          

          
          <div class="method-source-code" id="text_mixer_range_copy-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 314</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_mixer_range_copy</span>
  <span class="ruby-identifier">p</span> <span class="ruby-string">&quot;text_mixer_range_copy&quot;</span>
    <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-value">0</span>, [<span class="ruby-string">&quot;text&quot;</span>, <span class="ruby-string">&quot;Not yet implemented&quot;</span>])
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@new_text_area</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_mixer_range_delete" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_mixer_range_delete</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ol><li>
<p>Delete a block of lines</p>
</li></ol>
          
          

          
          <div class="method-source-code" id="text_mixer_range_delete-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 298</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_mixer_range_delete</span>
  <span class="ruby-identifier">p</span> <span class="ruby-string">&quot;text_mixer_range_delete&quot;</span>
  <span class="ruby-ivar">@new_text_area</span> = {}
  <span class="ruby-ivar">@text_area_index</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ta</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">unless</span> (<span class="ruby-ivar">@line_start</span><span class="ruby-operator">..</span><span class="ruby-ivar">@line_end</span>).<span class="ruby-identifier">cover?</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>])
      <span class="ruby-identifier">p</span> <span class="ruby-node">&quot;ta[0] #{ta[0]}&quot;</span>
      <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@text_area_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>]) 
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ta</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span> <span class="ruby-identifier">ta</span> }
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@new_text_area</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_mixer_range_exclude" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_mixer_range_exclude</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ol><li>
<p>Delete excluded lines in range.</p>
</li></ol>

<p>Request is for a range of lines to be deleted if excluded from the display</p>
          
          

          
          <div class="method-source-code" id="text_mixer_range_exclude-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 250</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_mixer_range_exclude</span>
  <span class="ruby-identifier">p</span> <span class="ruby-string">&quot;text_mixer_range_exclude&quot;</span>
  <span class="ruby-ivar">@exclude_count</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ta</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@line_start</span>        <span class="ruby-comment"># copy to new text area</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@line_start</span><span class="ruby-operator">..</span><span class="ruby-ivar">@line_end</span>).<span class="ruby-identifier">cover?</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>])                        <span class="ruby-comment"># in range?</span>
      <span class="ruby-identifier">ta1</span> = <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>]                                                    <span class="ruby-comment"># get [type, data]</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">ta1</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;text&quot;</span>
        <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>])
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>  
    <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>], [<span class="ruby-string">&quot;fill&quot;</span>, <span class="ruby-string">&quot;&quot;</span>]) <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@line_end</span><span class="ruby-operator">...</span><span class="ruby-ivar">@block_end_index</span>).<span class="ruby-identifier">cover?</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>])                                                                                    
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@block_end_index</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@line_end</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-ivar">@block_end_index</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@block_end_count</span>            <span class="ruby-comment"># end exclude does not overlap</span>
        <span class="ruby-identifier">excluded_count</span> = <span class="ruby-ivar">@block_end_index</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@line_end</span>
        <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>], [<span class="ruby-string">&quot;before&quot;</span>, <span class="ruby-identifier">excluded_count</span>])      <span class="ruby-comment"># new exclude count</span>
      <span class="ruby-keyword">else</span>                                                            <span class="ruby-comment"># end exclude does overlap  </span>
        <span class="ruby-identifier">excluded_count</span> = (<span class="ruby-ivar">@block_end_index</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@line_end</span>)
        <span class="ruby-identifier">excluded_count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@block_end_index</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@line_end</span>          <span class="ruby-comment"># still counts as a line</span>
        <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>], [<span class="ruby-string">&quot;before&quot;</span>, <span class="ruby-identifier">excluded_count</span>])  
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@block_end_index</span>
      <span class="ruby-identifier">text_write_area</span>(<span class="ruby-ivar">@block_end_index</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>, <span class="ruby-ivar">@text_end</span>)                <span class="ruby-comment"># include these lines</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@new_text_area</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_mixer_range_include" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_mixer_range_include</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ol><li>
<p>Delete included lines in range.</p>
</li></ol>

<p>Request is for a range of lines to be deleted if included in the display.
test_text_exclude_0x00 is the test case.</p>
          
          

          
          <div class="method-source-code" id="text_mixer_range_include-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 222</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_mixer_range_include</span>
  <span class="ruby-ivar">@exclude_count</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@deleted_count</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ta</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@line_start</span>
      <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>])                            <span class="ruby-comment"># copy to new text area</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@line_start</span><span class="ruby-operator">..</span><span class="ruby-ivar">@line_end</span>).<span class="ruby-identifier">cover?</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>])                      <span class="ruby-comment"># in range?</span>
      <span class="ruby-identifier">ta1</span> = <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>]                                                  <span class="ruby-comment"># get [type, data]</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">ta1</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;text&quot;</span>
        <span class="ruby-ivar">@deleted_count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> 
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>])  <span class="ruby-keyword">if</span> <span class="ruby-identifier">ta1</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;fill&quot;</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@line_end</span>
          <span class="ruby-ivar">@exclude_count</span> = <span class="ruby-ivar">@line_end</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@line_start</span>
          <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>], [<span class="ruby-string">&quot;before&quot;</span>, <span class="ruby-ivar">@exclude_count</span>]) 
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@line_end</span>
      <span class="ruby-identifier">text_write_area</span>(<span class="ruby-ivar">@block_end_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>, <span class="ruby-ivar">@text_end</span>)              <span class="ruby-comment"># include these lines</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@new_text_area</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_mixer_range_insert" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_mixer_range_insert</span><span
            class="method-args">(parameters)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ol><li>
<p>Insert lines.</p>
</li></ol>

<p>Not really working but an interesting start</p>
          
          

          
          <div class="method-source-code" id="text_mixer_range_insert-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 281</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_mixer_range_insert</span>(<span class="ruby-identifier">parameters</span>)
  <span class="ruby-identifier">p</span> <span class="ruby-string">&quot;text_mixer_range_insert&quot;</span>
  <span class="ruby-ivar">@text_lines_index</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@text_lines</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">tl</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@line_start</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">tl</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">+</span> <span class="ruby-value">2</span>
      <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@text_lines_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">tl</span>[<span class="ruby-value">1</span>])
      <span class="ruby-ivar">@line_start</span>.<span class="ruby-identifier">upto</span>(<span class="ruby-ivar">@line_end</span>) { <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@text_lines_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>, <span class="ruby-string">&quot;insert&quot;</span>) } 
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-ivar">@text_lines_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">tl</span>[<span class="ruby-value">1</span>])
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">text_exclude</span>(<span class="ruby-ivar">@text_area</span>)
  <span class="ruby-identifier">text_mixer</span>(<span class="ruby-ivar">@text_area</span>, <span class="ruby-identifier">parameters</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@text_area</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_mixer_range_move" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_mixer_range_move</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ol><li>
<p>Move lines before or after.</p>
</li></ol>

<p>Request is for a block of lines to be moved</p>
          
          

          
          <div class="method-source-code" id="text_mixer_range_move-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 322</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_mixer_range_move</span>
  <span class="ruby-identifier">p</span> <span class="ruby-string">&quot;text_mixer_range_move&quot;</span>
    <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-value">0</span>, [<span class="ruby-string">&quot;text&quot;</span>, <span class="ruby-string">&quot;Not yet implemented&quot;</span>])
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@new_text_area</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_write_area" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_write_area</span><span
            class="method-args">(from, to)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The text area is the “memory” map used to build the display logged to
console. This gets called out of the various formatter to write a line from
memory to the display.  Format is typically: [23, [“fill”, “”]] or [24,
[“before”, 13]]</p>
          
          

          
          <div class="method-source-code" id="text_write_area-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 331</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_write_area</span>(<span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span>)
  <span class="ruby-ivar">@text_area</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">ta</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">ta</span>[<span class="ruby-value">1</span>])  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">from</span><span class="ruby-operator">..</span><span class="ruby-identifier">to</span>).<span class="ruby-identifier">cover?</span>(<span class="ruby-identifier">ta</span>[<span class="ruby-value">0</span>]) }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-text_write_lines" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">text_write_lines</span><span
            class="method-args">(from, to)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The text lines area is the copy of the original file read in from disk. All
this does is write from the text lines area to the display when requested
by formatters that are restoring excluded lines. Format is: [25, [“text”,
“25 r s t u v rstuv line2”]]</p>
          
          

          
          <div class="method-source-code" id="text_write_lines-source">
            <pre><span class="ruby-comment"># File TextProcessor.rb, line 339</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">text_write_lines</span>(<span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span>)
  <span class="ruby-ivar">@text_lines</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">tl</span><span class="ruby-operator">|</span>  <span class="ruby-ivar">@new_text_area</span>.<span class="ruby-identifier">store</span>(<span class="ruby-identifier">tl</span>[<span class="ruby-value">0</span>]<span class="ruby-operator">+</span><span class="ruby-value">1</span>, [<span class="ruby-string">&quot;text&quot;</span>, <span class="ruby-identifier">tl</span>[<span class="ruby-value">1</span>]]) <span class="ruby-keyword">if</span> (<span class="ruby-identifier">from</span><span class="ruby-operator">..</span><span class="ruby-identifier">to</span>).<span class="ruby-identifier">cover?</span>(<span class="ruby-identifier">tl</span>[<span class="ruby-value">0</span>]) }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://docs.seattlerb.org/rdoc/">RDoc</a> 4.2.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

